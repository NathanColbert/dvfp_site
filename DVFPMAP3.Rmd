
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width = 20, fig.height=10}
library(leaflet)
library(dplyr)
map <- read.csv("DVFP Composer Travels.csv", header = TRUE) # Moved coordinates slightly

r_map <- map %>% filter(Composer == "Sergei Rachmaninoff")
t_map <- map %>% filter(Composer == "Pyotr Ilyich Tchaikovsky")
br_map <- map %>% filter(Composer == "Johannes Brahms")
be_map <- map %>% filter(Composer == "Hector Berlioz")
ch_map <- map %>% filter(Composer == "Frederic Chopin")
m_map <- map %>% filter(Composer == "Gustav Mahler")
beet_map <- map %>% filter(Composer == "Ludwig van Beethoven")
dvo_map <- map %>% filter(Composer == "Antonin Dvorak")
ver_map <- map %>% filter(Composer == "Giuseppe Verdi")


rach_map <- data.frame(Group = map$Composer[1],
                   Lat = c(map$GeoBornLat[1], map$GeoSchoolLat[1],
                           map$GeoDiedLat[1]),
                   Long = c(map$GeoBornLong[1], map$GeoSchoolLong[1], 
                            map$GeoDiedLong[1]))

tchai_map <- data.frame(Group = map$Composer[2],
                   Lat = c(map$GeoBornLat[2], map$GeoSchoolLat[2],
                           map$GeoDiedLat[2]),
                   Long = c(map$GeoBornLong[2], map$GeoSchoolLong[2], 
                            map$GeoDiedLong[2]))
brahms_map <- data.frame(Group = map$Composer[3],
                   Lat = c(map$GeoBornLat[3], map$GeoSchoolLat[3],
                           map$GeoDiedLat[3]),
                   Long = c(map$GeoBornLong[3], map$GeoSchoolLong[3], 
                            map$GeoDiedLong[3]))
berlioz_map <- data.frame(Group = map$Composer[4],
                  Lat = c(map$GeoBornLat[4], map$GeoSchoolLat[4],
                           map$GeoDiedLat[4]),
                   Long = c(map$GeoBornLong[4], map$GeoSchoolLong[4], 
                            map$GeoDiedLong[4]))
chopin_map <- data.frame(Group = map$Composer[5],
                   Lat = c(map$GeoBornLat[5], map$GeoSchoolLat[5],
                           map$GeoDiedLat[5]),
                   Long = c(map$GeoBornLong[5], map$GeoSchoolLong[5], 
                            map$GeoDiedLong[5]))
beethoven_map <- data.frame(Group = map$Composer[6],
                   Lat = c(map$GeoBornLat[6], map$GeoSchoolLat[6],
                           map$GeoDiedLat[6]),
                   Long = c(map$GeoBornLong[6], map$GeoSchoolLong[6], 
                            map$GeoDiedLong[6]))

dvorak_map <- data.frame(Group = map$Composer[7],
                   Lat = c(map$GeoBornLat[7], map$GeoSchoolLat[7],
                           map$GeoDiedLat[7]),
                   Long = c(map$GeoBornLong[7], map$GeoSchoolLong[7], 
                            map$GeoDiedLong[7]))

verdi_map <- data.frame(Group = map$Composer[8],
                   Lat = c(map$GeoBornLat[8], map$GeoSchoolLat[8],
                           map$GeoDiedLat[8]),
                   Long = c(map$GeoBornLong[8], map$GeoSchoolLong[8], 
                            map$GeoDiedLong[8]))

mahler_map <- data.frame(Group = map$Composer[9],
                   Lat = c(map$GeoBornLat[9], map$GeoSchoolLat[9],
                           map$GeoDiedLat[9]),
                   Long = c(map$GeoBornLong[9], map$GeoSchoolLong[9], 
                            map$GeoDiedLong[9]))


one_icon <- icons(
  makeIcon(iconUrl = "baby2.png"),
  iconWidth = 40, iconHeight = 50
)

two_icon <- icons(
  makeIcon(iconUrl = "ts2.png"),
  iconWidth = 40, iconHeight = 50
)

three_icon <- icons(
  makeIcon(iconUrl = "school.png"),
  iconWidth = 40, iconHeight = 50
)

content <- paste("Composer:", map$Composer, "<br/>",
                 "Birth Date:", map$BirthDate, "<br/>",
                 "Birth Place:", map$Born, "<br/>",
                 "Quote:", map$Quote, "<br/>")
content1 <- paste("Composer:", map$Composer, "<br/>",
                 "School Name:", map$SchoolName, "<br/>",
                 "School City:", map$SchoolCity, "<br/>",
                 "Teacher:", map$TeacherName, "<br/>")
content3 <- paste("Composer:", map$Composer, "<br/>",
                  "Death Date:", map$DeathDate, "<br/>",
                 "Death Place", map$Died, "<br/>")


m <- leaflet(width = "100%") %>% 
  setView(lat = map$GeoSchoolLat[3],
          lng = map$GeoSchoolLong[3], zoom = 5)  %>%
  addTiles('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png') %>% 
  
  #Beethoven
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[6], group = "Beethoven", 
             icon = one_icon, data = beet_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[6], group = "Beethoven", 
             icon = three_icon, data = beet_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[6], group = "Beethoven", 
             icon = two_icon, data = beet_map) %>% 

  #Berlioz
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[4], group = "Berlioz", 
             icon = one_icon, data = be_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[4], group = "Berlioz", 
             icon = three_icon, data = be_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[4], group = "Berlioz", 
             icon = two_icon, data = be_map) %>%     
  #Brahms 
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[3], group = "Brahms", 
             icon = one_icon, data = br_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[3], group = "Brahms", 
             icon = three_icon, data = br_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[3], group = "Brahms", 
             icon = two_icon, data = br_map) %>% 
  
  #Chopin
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[5], group = "Chopin", 
             icon = one_icon, data = ch_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[5], group = "Chopin", 
             icon = three_icon, data = ch_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[5], group = "Chopin", 
             icon = two_icon, data = ch_map) %>% 
  

  #Dvorak
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[7], group = "Dvorak", 
             icon = one_icon, data = dvo_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[7], group = "Dvorak", 
             icon = three_icon, data = dvo_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[7], group = "Dvorak", 
             icon = two_icon, data = dvo_map) %>%


  
  #Mahler
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[9], group = "Mahler", 
             icon = one_icon, data = m_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[9], group = "Mahler", 
             icon = three_icon, data = m_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[9], group = "Mahler", 
             icon = two_icon, data = m_map) %>% 
  
  #Rachmaninoff
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[1], group = "Rachmaninoff", 
             icon = one_icon, data = r_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[1], group = "Rachmaninoff", 
             icon = three_icon, data = r_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[1], group = "Rachmaninoff", 
             icon = two_icon, data = r_map) %>%
  
 #Tchaikovsky
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[2], group = "Tchaikovsky", 
             icon = one_icon, data = t_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[2], group = "Tchaikovsky", 
             icon = three_icon, data = t_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[2], group = "Tchaikovsky", 
             icon = two_icon, data = t_map) %>%
  #Verdi  
  addMarkers(~GeoBornLong, ~GeoBornLat,
             popup = content[8], group = "Verdi", 
             icon = one_icon, data = ver_map) %>% 
  addMarkers(~GeoSchoolLong, ~GeoSchoolLat,
             popup = content1[8], group = "Verdi", 
             icon = three_icon, data = ver_map) %>% 
  addMarkers(~GeoDiedLong, ~GeoDiedLat,
             popup = content3[8], group = "Verdi", 
             icon = two_icon, data = ver_map) %>%    
  
    
  addPolylines(data = rach_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#8B0000", group = "Rachmaninoff") %>%
  addPolylines(data = tchai_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#CFB53B", group = "Tchaikovsky") %>%
  addPolylines(data = brahms_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#228B22", group = "Brahms") %>%
  addPolylines(data = berlioz_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#800080", group = "Berlioz") %>%
  addPolylines(data = chopin_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#87ceeb", group = "Chopin") %>%
  addPolylines(data = beethoven_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#8B4513", group = "Beethoven") %>%
  addPolylines(data = dvorak_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1, 
               color = "#A9A9A9", group = "Dvorak") %>%
  addPolylines(data = verdi_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#FF8C00", group = "Verdi") %>%  
  addPolylines(data = mahler_map, lng = ~Long, lat = ~Lat,
               smoothFactor = 4, weight = 2, opacity = 1,
               color = "#32CD32", group = "Mahler") %>%  
  addLayersControl(
    baseGroups = c("OpenStreetMap"),
    overlayGroups = c("Beethoven","Berlioz", "Brahms",  "Chopin", "Dvorak",
                      "Mahler","Rachmaninoff", "Tchaikovsky", "Verdi"),
    options = layersControlOptions(collapsed = FALSE)) %>%
  hideGroup(c("Beethoven","Berlioz","Chopin",  "Dvorak",
              "Mahler","Rachmaninoff", "Tchaikovsky", "Verdi"))


m
#Done for now!

library(widgetframe)
htmlwidgets::saveWidget(frameableWidget(m),'dvfpmap2.html')

```
